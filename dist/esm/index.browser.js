async function generateKey(bitLength = 256, extractable = false) {
    const aesGcmParams = {
        name: 'AES-GCM',
        length: bitLength
    };
    return await crypto.subtle.generateKey(aesGcmParams, extractable, ['encrypt', 'decrypt']);
}
async function exportJwk(key) {
    if (!key.extractable) {
        throw new Error('Provided key is not extractable. Consider passing the extractable argument to generateKey or importKey method if you need to extract the key');
    }
    return await crypto.subtle.exportKey('jwk', key);
}
async function importKey(key, extractable = false) {
    if (key.byteLength !== undefined) {
        return await crypto.subtle.importKey('raw', key, {
            name: 'AES-GCM'
        }, extractable, ['encrypt', 'decrypt']);
    }
    return await crypto.subtle.importKey('jwk', key, {
        name: 'AES-GCM'
    }, extractable, ['encrypt', 'decrypt']);
}
async function encrypt(plaintext, key) {
    const iv = crypto.getRandomValues(new Uint8Array(12));
    const aesGcmParams = {
        name: 'AES-GCM',
        iv
    };
    const encrypted = await crypto.subtle.encrypt(aesGcmParams, key, plaintext);
    return {
        encrypted,
        iv
    };
}
async function decrypt(ciphertext, key) {
    const aesGcmParams = { name: 'AES-GCM', iv: ciphertext.iv };
    return await crypto.subtle.decrypt(aesGcmParams, key, ciphertext.encrypted);
}

export { decrypt, encrypt, exportJwk, generateKey, importKey };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguYnJvd3Nlci5qcyIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3RzL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB0eXBlIEFlc0tleUxlbmd0aCA9IDEyOCB8IDE5MiB8IDI1NlxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVLZXkgKGJpdExlbmd0aDogbnVtYmVyID0gMjU2LCBleHRyYWN0YWJsZTogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTxDcnlwdG9LZXk+IHtcbiAgY29uc3QgYWVzR2NtUGFyYW1zOiBBZXNLZXlHZW5QYXJhbXMgPSB7XG4gICAgbmFtZTogJ0FFUy1HQ00nLFxuICAgIGxlbmd0aDogYml0TGVuZ3RoXG4gIH1cbiAgcmV0dXJuIGF3YWl0IGNyeXB0by5zdWJ0bGUuZ2VuZXJhdGVLZXkoYWVzR2NtUGFyYW1zLCBleHRyYWN0YWJsZSwgWydlbmNyeXB0JywgJ2RlY3J5cHQnXSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4cG9ydEp3ayAoa2V5OiBDcnlwdG9LZXkpOiBQcm9taXNlPEpzb25XZWJLZXk+IHtcbiAgaWYgKCFrZXkuZXh0cmFjdGFibGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Byb3ZpZGVkIGtleSBpcyBub3QgZXh0cmFjdGFibGUuIENvbnNpZGVyIHBhc3NpbmcgdGhlIGV4dHJhY3RhYmxlIGFyZ3VtZW50IHRvIGdlbmVyYXRlS2V5IG9yIGltcG9ydEtleSBtZXRob2QgaWYgeW91IG5lZWQgdG8gZXh0cmFjdCB0aGUga2V5JylcbiAgfVxuICByZXR1cm4gYXdhaXQgY3J5cHRvLnN1YnRsZS5leHBvcnRLZXkoJ2p3aycsIGtleSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGltcG9ydEtleSAoa2V5OiBKc29uV2ViS2V5IHwgQnVmZmVyU291cmNlLCBleHRyYWN0YWJsZTogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTxDcnlwdG9LZXk+IHtcbiAgaWYgKChrZXkgYXMgQXJyYXlCdWZmZXIpLmJ5dGVMZW5ndGggIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBhd2FpdCBjcnlwdG8uc3VidGxlLmltcG9ydEtleSgncmF3Jywga2V5IGFzIEJ1ZmZlclNvdXJjZSwge1xuICAgICAgbmFtZTogJ0FFUy1HQ00nXG4gICAgfSwgZXh0cmFjdGFibGUsIFsnZW5jcnlwdCcsICdkZWNyeXB0J10pXG4gIH1cbiAgcmV0dXJuIGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KCdqd2snLCBrZXkgYXMgSnNvbldlYktleSwge1xuICAgIG5hbWU6ICdBRVMtR0NNJ1xuICB9LCBleHRyYWN0YWJsZSwgWydlbmNyeXB0JywgJ2RlY3J5cHQnXSlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDaXBoZXJ0ZXh0IHtcbiAgZW5jcnlwdGVkOiBBcnJheUJ1ZmZlclxuICBpdjogVWludDhBcnJheVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5jcnlwdCAocGxhaW50ZXh0OiBCdWZmZXJTb3VyY2UsIGtleTogQ3J5cHRvS2V5KTogUHJvbWlzZTxDaXBoZXJ0ZXh0PiB7XG4gIGNvbnN0IGl2ID0gY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheSgxMikpXG4gIGNvbnN0IGFlc0djbVBhcmFtczogQWVzR2NtUGFyYW1zID0ge1xuICAgIG5hbWU6ICdBRVMtR0NNJyxcbiAgICBpdlxuICB9XG4gIGNvbnN0IGVuY3J5cHRlZCA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZW5jcnlwdChhZXNHY21QYXJhbXMsIGtleSwgcGxhaW50ZXh0KVxuICByZXR1cm4ge1xuICAgIGVuY3J5cHRlZCxcbiAgICBpdlxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWNyeXB0IChjaXBoZXJ0ZXh0OiBDaXBoZXJ0ZXh0LCBrZXk6IENyeXB0b0tleSk6IFByb21pc2U8QXJyYXlCdWZmZXI+IHtcbiAgY29uc3QgYWVzR2NtUGFyYW1zOiBBZXNHY21QYXJhbXMgPSB7IG5hbWU6ICdBRVMtR0NNJywgaXY6IGNpcGhlcnRleHQuaXYgfVxuICByZXR1cm4gYXdhaXQgY3J5cHRvLnN1YnRsZS5kZWNyeXB0KGFlc0djbVBhcmFtcywga2V5LCBjaXBoZXJ0ZXh0LmVuY3J5cHRlZClcbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFTyxlQUFlLFdBQVcsQ0FBRSxTQUFvQixHQUFBLEdBQUcsRUFBRSxXQUFBLEdBQXVCLEtBQUssRUFBQTtBQUN0RixJQUFBLE1BQU0sWUFBWSxHQUFvQjtBQUNwQyxRQUFBLElBQUksRUFBRSxTQUFTO0FBQ2YsUUFBQSxNQUFNLEVBQUUsU0FBUztLQUNsQixDQUFBO0FBQ0QsSUFBQSxPQUFPLE1BQU0sTUFBTSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxFQUFFLFdBQVcsRUFBRSxDQUFDLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFBO0FBQzNGLENBQUM7QUFFTSxlQUFlLFNBQVMsQ0FBRSxHQUFjLEVBQUE7QUFDN0MsSUFBQSxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRTtBQUNwQixRQUFBLE1BQU0sSUFBSSxLQUFLLENBQUMsOElBQThJLENBQUMsQ0FBQTtBQUNoSyxLQUFBO0lBQ0QsT0FBTyxNQUFNLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsQ0FBQTtBQUNsRCxDQUFDO0FBRU0sZUFBZSxTQUFTLENBQUUsR0FBOEIsRUFBRSxjQUF1QixLQUFLLEVBQUE7QUFDM0YsSUFBQSxJQUFLLEdBQW1CLENBQUMsVUFBVSxLQUFLLFNBQVMsRUFBRTtRQUNqRCxPQUFPLE1BQU0sTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLEdBQW1CLEVBQUU7QUFDL0QsWUFBQSxJQUFJLEVBQUUsU0FBUztTQUNoQixFQUFFLFdBQVcsRUFBRSxDQUFDLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFBO0FBQ3hDLEtBQUE7SUFDRCxPQUFPLE1BQU0sTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLEdBQWlCLEVBQUU7QUFDN0QsUUFBQSxJQUFJLEVBQUUsU0FBUztLQUNoQixFQUFFLFdBQVcsRUFBRSxDQUFDLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFBO0FBQ3pDLENBQUM7QUFPTSxlQUFlLE9BQU8sQ0FBRSxTQUF1QixFQUFFLEdBQWMsRUFBQTtBQUNwRSxJQUFBLE1BQU0sRUFBRSxHQUFHLE1BQU0sQ0FBQyxlQUFlLENBQUMsSUFBSSxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQTtBQUNyRCxJQUFBLE1BQU0sWUFBWSxHQUFpQjtBQUNqQyxRQUFBLElBQUksRUFBRSxTQUFTO1FBQ2YsRUFBRTtLQUNILENBQUE7QUFDRCxJQUFBLE1BQU0sU0FBUyxHQUFHLE1BQU0sTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRSxTQUFTLENBQUMsQ0FBQTtJQUMzRSxPQUFPO1FBQ0wsU0FBUztRQUNULEVBQUU7S0FDSCxDQUFBO0FBQ0gsQ0FBQztBQUVNLGVBQWUsT0FBTyxDQUFFLFVBQXNCLEVBQUUsR0FBYyxFQUFBO0FBQ25FLElBQUEsTUFBTSxZQUFZLEdBQWlCLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxFQUFFLEVBQUUsVUFBVSxDQUFDLEVBQUUsRUFBRSxDQUFBO0FBQ3pFLElBQUEsT0FBTyxNQUFNLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFBO0FBQzdFOzs7OyJ9
